\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{geometry}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{titlesec}
\usepackage{fancyhdr}
\usepackage{amsmath}

\geometry{a4paper, margin=1in}
\setlength{\parindent}{0pt}
\setlength{\parskip}{1em}

% Define colors for code highlighting
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}

\lstset{style=mystyle}

% Header formatting
\pagestyle{fancy}
\fancyhf{}
\rhead{NPC Colosseum Bot Programming}
\lhead{\leftmark}
\rfoot{Page \thepage}

\title{\Huge\textbf{NPC Colosseum Bot Programming Manual}}
\author{DeepSeek}
\date{\today}

\begin{document}

\maketitle

\begin{center}
\textit{Create intelligent bots to battle in the arena!}
\end{center}

\vspace{2em}

\tableofcontents
\newpage

\section{Introduction}
\label{sec:introduction}

Welcome to the NPC Colosseum Bot Programming Guide! This document will help you understand how to create your own AI bots to battle in the arena. In NPC Colosseum, you can program bots that control characters during AI vs AI matches. Your bot will receive game state information and must return valid actions to compete against other bots.

\section{Accessing the code}
We should have given you an IP address and port at the beginning of the event. \texttt{ssh} into that address. The code for the game should already be there.
You can either use \texttt{scp} to copy your bot's code to the same place as the game, or you can create a file there and copy-paste the contents.
Note that you won't be able to see the code that runs the game, that is intentional. But you will still be able to run the game using
`\texttt{python main.py}'
\section{Bot Function Structure}
\label{sec:bot-structure}

Your bot must be implemented as a Python function with the following signature:

\begin{lstlisting}[language=Python, caption=Bot Function Signature]
def get_bot_action(current_game_state, game_archive):
    # Your bot logic here
    return "Valid Action String"
\end{lstlisting}

\subsection{Parameters}
\begin{itemize}
    \item \texttt{current\_game\_state}: A dictionary containing the current state of the game
    \item \texttt{game\_archive}: A list containing the complete history of all turns played so far, including actions taken and their results
\end{itemize}

\subsection{Return Value}
Your function must return a string representing a valid action.

\subsection{Class selection}
You must also implement a class selection function \texttt{get\_bot\_class}

\begin{lstlisting}[language=Python, caption=Bot Function Signature]
def get_bot_class():
    return class
\end{lstlisting}

Class is a number between 0 and 2. 
\begin{itemize}
    \item 0: Warrior
    \item 1: Mage
    \item 2: Rogue
\end{itemize}

\section{Game State Structure}
\label{sec:game-state}

The \texttt{current\_game\_state} dictionary contains:

\begin{lstlisting}[language=Python, caption=Game State Structure]
{
    "player": {
        "hp": current_health_points,
        "max_hp": maximum_health_points,
        "skill_points": current_skill_points,
        "character_class": "Warrior"  # or "Mage" or "Rogue"
    },
    "opponent": {
        "hp": current_health_points,
        "max_hp": maximum_health_points,
        "skill_points": current_skill_points,
        "character_class": "Warrior"  # or "Mage" or "Rogue"
    },
    "inventory": {
        "Potion": count,
        "Ether": count,
        "Bomb": count,
        "Elixir": count
    }
}
\end{lstlisting}

\section{Game Archive Structure}
\label{sec:game-archive}

The \texttt{game\_archive} parameter provides a complete history of the battle, containing every turn played so far. This is extremely valuable for creating intelligent bots that can learn from past actions and adapt their strategies.

\subsection{Archive Structure}
Each entry in the \texttt{game\_archive} list has the following structure:

\begin{lstlisting}[language=Python, caption=Game Archive Entry Structure]
{
    "player": {
        "hp": player_health_at_turn_start,
        "max_hp": player_max_health,
        "skill_points": player_sp_at_turn_start,
        "character_class": "Warrior"
    },
    "opponent": {
        "hp": opponent_health_at_turn_start,
        "max_hp": opponent_max_health,
        "skill_points": opponent_sp_at_turn_start,
        "character_class": "Mage"
    },
    "inventory": {
        "Potion": count_at_turn_start,
        "Ether": count_at_turn_start,
        "Bomb": count_at_turn_start,
        "Elixir": count_at_turn_start
    },
    "action": ["action_taken", "result_message"]
}
\end{lstlisting}

 \subsection{Using the Game Archive}
% The archive allows your bot to analyze battle patterns and make strategic decisions:
% 
% \begin{lstlisting}[language=Python, caption=Example Archive Usage]
% def get_bot_action(current_game_state, game_archive):
%     # Analyze opponent's behavior patterns
%     if len(game_archive) > 0:
%         last_turn = game_archive[-1]
%         last_action = last_turn["action"][0]
%         last_result = last_turn["action"][1]
%         
%         # Check if opponent frequently uses certain skills
%         skill_usage = {}
%         for turn in game_archive:
%             action = turn["action"][0]
%             if action.startswith("Cast "):
%                 skill = action[5:]  # Remove "Cast " prefix
%                 skill_usage[skill] = skill_usage.get(skill, 0) + 1
%         
%         # Counter opponent's most used skill
%         if skill_usage:
%             most_used_skill = max(skill_usage, key=skill_usage.get)
%             # Implement counter strategy...
%     
%     # Your main bot logic here...
%     return "Attack"
% \end{lstlisting}

\subsection{Archive Analysis Strategies}
\begin{itemize}
    \item \textbf{Pattern Recognition}: Identify which skills/items your opponent uses most frequently
    \item \textbf{Health Trends}: Track how quickly each character's health is decreasing
    \item \textbf{Resource Management}: Monitor skill point usage and regeneration patterns
    \item \textbf{Timing Analysis}: Determine when opponents use healing items or defensive skills
\end{itemize}

\section{Actions Reference}
\label{sec:actions}

\subsection{Basic Actions}
\begin{itemize}
    \item \texttt{"Attack"} - Perform a basic attack
    \item \texttt{"Defend"} - Defend against the next attack
\end{itemize}

\subsection{Item Actions}
\begin{itemize}
    \item \texttt{"Use Potion"} - Heal 30 HP
    \item \texttt{"Use Ether"} - Heal 15 HP  
    \item \texttt{"Use Bomb"} - Deal 40 damage
    \item \texttt{"Use Elixir"} - Fully restore HP
\end{itemize}

\subsection{Class-Specific Skills}
\label{subsec:skills}

\subsubsection{Warrior Skills}
\begin{itemize}
    \item \texttt{"Cast Power Strike"} - Heavy weapon attack (30-40 damage, 3 SP)
    \item \texttt{"Cast Shield Bash"} - Stuns and damages (20-30 damage, 2 SP)
    \item \texttt{"Cast Battle Cry"} - Heals HP (20-30 heal, 3 SP)
    \item \texttt{"Cast Whirlwind"} - Hits all enemies (25-35 damage, 4 SP)
\end{itemize}

\subsubsection{Mage Skills}
\begin{itemize}
    \item \texttt{"Cast Fireball"} - High damage fire spell (35-45 damage, 5 SP)
    \item \texttt{"Cast Ice Shard"} - Freezing damage (25-35 damage, 3 SP)
    \item \texttt{"Cast Arcane Heal"} - Powerful healing (35-45 heal, 4 SP)
    \item \texttt{"Cast Lightning Bolt"} - Massive lightning damage (40-50 damage, 6 SP)
\end{itemize}

\subsubsection{Rogue Skills}
\begin{itemize}
    \item \texttt{"Cast Backstab"} - High damage from behind (35-45 damage, 4 SP)
    \item \texttt{"Cast Poison Dart"} - Damage over time (0-10 damage + poison, 3 SP)
    \item \texttt{"Cast Shadow Dodge"} - Evade next attack (100 defense for 1 turn, 3 SP)
    \item \texttt{"Cast Quick Strike"} - Fast, low cost attack (25-35 damage, 2 SP)
\end{itemize}

\section{Character Classes}
\label{sec:character-classes}

\subsection{Warrior}
\begin{itemize}
    \item \textbf{Max HP}: 240
    \item \textbf{Basic Attack}: 18-25 damage
    \item \textbf{Skill Points}: 4
    \item \textbf{Defense}: 15
    \item \textbf{Starting Inventory}: 4 Potions, 1 Ether, 1 Bomb, 1 Elixir
\end{itemize}

\subsection{Mage}
\begin{itemize}
    \item \textbf{Max HP}: 160
    \item \textbf{Basic Attack}: 10-16 damage
    \item \textbf{Skill Points}: 8
    \item \textbf{Defense}: 25
    \item \textbf{Starting Inventory}: 2 Potions, 3 Ether, 2 Bombs, 1 Elixir
\end{itemize}

\subsection{Rogue}
\begin{itemize}
    \item \textbf{Max HP}: 200
    \item \textbf{Basic Attack}: 15-22 damage
    \item \textbf{Skill Points}: 6
    \item \textbf{Defense}: 40
    \item \textbf{Starting Inventory}: 3 Potions, 2 Ether, 3 Bombs, 1 Elixir
\end{itemize}

\section{Inventory Items}
\label{sec:inventory}

\begin{itemize}
    \item \textbf{Potion}: Heals 35 HP
    \item \textbf{Ether}: Heals 20 HP
    \item \textbf{Bomb}: Deals 40 damage
    \item \textbf{Elixir}: Heals 80 HP (rare)
\end{itemize}

\section{Strategy Guide}
\label{sec:strategy}

\subsection{General Tips}
\begin{enumerate}
    \item \textbf{Monitor Health}: Use healing items when HP drops below 40
    \item \textbf{Manage Skill Points}: Basic attacks restore SP for some classes
    \item \textbf{Class Synergy}: Choose actions that complement your class strengths
    \item \textbf{Opponent Awareness}: Consider the opponent's class and health when choosing actions
    \item \textbf{Resource Management}: Don't waste powerful items or skills unnecessarily
\end{enumerate}

\subsection{Class-Specific Strategies}
\begin{itemize}
    \item \textbf{Warrior}: Use high-damage skills and defend to build skill points
    \item \textbf{Mage}: Manage skill points carefully and use powerful spells strategically
    \item \textbf{Rogue}: Use evasion and poison effects to control the battle
\end{itemize}

\subsection{Skill Points}
Skill points (SP) are utilized to cast skills which are unique to every class. The methods of regeneration of skill points for each class is as follows:
\begin{itemize}
    \item \textbf{Warrior}: Using "Defend" during a turn regenerates 1 SP.
    \item \textbf{Mage}: Using "Attack" during a turn regenerates 2 SP.
    \item \textbf{Rogue}: Using "Attack" during a turn regenerates 1 SP.
\end{itemize}

\subsection{Defense and Dodging}
The stat "Defense" is different from the action "Defend". The action "Defend" decreases the amount of damage taken by the character upon receiving damage during the opponent's turn. The stat "Defense" refers to the probability of a character to dodge an attack, receiving no damage from it. The stat is unique to each class and goes as follows:
\begin{itemize}
    \item \textbf{Warrior}: 15
    \item \textbf{Mage}: 25
    \item \textbf{Rogue}: 40
\end{itemize}
The probability of dodging an attack is $\frac{\text{Defense}}{100}$.

\subsection{Status Effects}
\begin{itemize}
    \item \textbf{Poison}: Applied by Rogue's "Poison Dart". Deals 5 damage per stack at the start of each turn, then reduces stacks by 1.
    \item \textbf{Shadow Dodge}: Applied by Rogue's "Shadow Dodge" skill. Sets defense to 100 for 1 turn, guaranteeing dodges.
\end{itemize}

\section{Advanced Bot Strategies}
\label{sec:advanced}

\subsection{Using the Game Archive for Machine Learning}
\begin{lstlisting}[language=Python, caption=Advanced Archive Analysis]
def get_bot_action(current_game_state, game_archive):
    # Calculate damage per turn
    if len(game_archive) >= 2:
        current_hp = current_game_state['opponent']['hp']
        two_turns_ago = game_archive[-2]['opponent']['hp']
        damage_taken = two_turns_ago - current_hp
        # Adjust strategy based on damage output
    
    # Predict opponent's next move
    opponent_class = current_game_state['opponent']['character_class']
    opponent_skills = CLASS_SKILLS[opponent_class]
    
    # Check if opponent is low on skill points
    opponent_sp = current_game_state['opponent']['skill_points']
    likely_actions = []
    
    if opponent_sp < 3:
        likely_actions.extend(["Attack", "Defend"])
    else:
        # Add skills they can afford
        for skill, data in opponent_skills.items():
            if data.get("cost", 0) <= opponent_sp:
                likely_actions.append(f"Cast {skill}")
    
    # Counter the most likely actions
    if "Cast Fireball" in likely_actions and current_game_state['player']['hp'] < 50:
        return "Defend"  # Defend against big attacks when low HP
    
    return "Attack"  # Default action
\end{lstlisting}

\section{Example Bot}
\label{sec:example}

Here's the simple bot provided in the game:

\begin{lstlisting}[language=Python, caption=Example Bot Implementation]
import random

def get_bot_action(current_game_state, game_archive):
    player_hp = current_game_state['player']['hp']
    inventory = current_game_state['inventory']
    
    # If HP is low and has a Potion, heal
    if player_hp < 40 and inventory.get("Potion", 0) > 0:
        return "Use Potion"
    
    # If opponent is low HP and we have a bomb, finish them!
    if current_game_state['opponent']['hp'] < 45 and inventory.get("Bomb", 0) > 0:
        return "Use Bomb"
        
    # Otherwise, cast a powerful spell or just attack
    if random.random() < 0.5: # 50% chance to cast Fireball
        return "Cast Fireball"
    else:
        return "Attack"
\end{lstlisting}

\section{Testing Your Bot}
\label{sec:testing}

\begin{enumerate}
    \item Replace the \texttt{get\_bot\_action} function in \texttt{player1.py} or \texttt{player2.py} with your implementation
    \item Run the game and select "AI vs AI" mode
    \item Watch how your bot performs against the default opponent bot
    \item Use the game archive analysis to debug and improve your strategy
    \item Iterate and improve your bot based on performance!
\end{enumerate}

\section{Troubleshooting}
\label{sec:troubleshooting}

\begin{itemize}
    \item \textbf{Invalid Action}: Make sure your bot returns exactly the action strings shown in this manual
    \item \textbf{Skill Points}: Check that you have enough skill points before using skills
    \item \textbf{Inventory}: Verify item counts before trying to use items
    \item \textbf{Class Skills}: Remember that skills are class-specific
    \item \textbf{Game Archive}: Ensure you're accessing the archive correctly - it contains complete turn history
    \item \textbf{Performance}: If your bot is too slow, consider limiting how much archive history you analyze
\end{itemize}

\begin{center}
\Large\textbf{Happy coding and may the best bot win!}
\end{center}

\end{document}
